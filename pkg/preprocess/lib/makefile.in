######################################################################
## Filename:      makefile.in
## Version:       
## Description:   
## Author:        Yannick Copin <y.copin@ipnl.in2p3.fr>
## Created at:    Tue Mar 25 16:21:56 2003
## $Id$
## Modified by:   Emmanuel Gangler <e.gangler@ipnl.in2p3.fr>
######################################################################

topdir = @top_srcdir@
top_builddir = $(topdir)
subdir = pkg/preprocess/lib
include $(topdir)/add_defs/makedefs
include $(topdir)/add_defs/makedefs.local

# ============================================================

# Targets

SRC = 	utils.c \

SRCC = bichip.cxx\
	catorfile.cxx\
	image.cxx \
	imagesnifs.cxx \
	section.cxx \
	sectionlist.cxx \
	analyser.cxx \
	ioplain.cxx \
	ioslice.cxx \
	imagestack.cxx \
	kombinator.cxx \
	kombinatorfit.cxx \
	imagestacksnifs.cxx \
	valuegetter.cxx \
	preprocessor.cxx \
	algocams.cxx\
	overscan.cxx\
	filter.cxx\

COBJ = $(patsubst %.c, $(O)/%.o, $(SRC))
CCOBJ = $(patsubst %.cxx, $(O)/%.o, $(SRCC))
OBJ = $(COBJ) $(CCOBJ)

LIB = $(O)/libpreprocess.a 

include make.depend

# ============================================================

OUT : dirobj $(LIB)

# Objects
$(COBJ) : $(O)/%.o : %.c $(STAND_INC) makefile
	$(C_COMPILE)

# Objects C++
$(CCOBJ) : $(O)/%.o : %.cxx $(STAND_INC) makefile
	$(CXXCOMPILE)

# Library
$(LIB) : $(OBJ) $(OBJ)
	$(AR) rv $(LIB) $(OBJ)
	$(RANLIB) $@

# placate make.depend .cxx .c .h dependancies
%.cxx %.c %.h :
	@echo ==============================
	@echo WARNING : $@ has disappeared
	@echo ==============================

clear:
	rm -f $(OBJ) $(EXE)

makefile: makefile.in  $(top_builddir)/config.status
	cd $(top_builddir) \
	  && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status

make.depend: makefile $(SRC) $(SRCC)
	$(CC) -MM $(CFLAGS) -c $(SRC) $(SRCC) | sed 's%\(.*\)\.o[ :]*%$$(O)/\1.o  :%' > make.depend

.PHONY : OUT all
